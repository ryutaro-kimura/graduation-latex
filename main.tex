% Shift-JIS CRLF 版
\documentclass[a4paper, 12pt]{jsreport}
\usepackage{bm}
\usepackage[dvipdfmx]{graphicx}
\usepackage{ascmac}
\usepackage{url}
\usepackage{float}


\title{FIWAREへの\\
佐賀市営バスデータの蓄積と利用
}
\author{佐賀大学
理工学部
知能情報システム学科\\
19238174
木村龍太郎}
\date{令和5年2月1日}


\begin{document}
  \maketitle


  \begin{abstract}
    \par 近年、スマートシティ実現に向けて、交通や観光、防災といった様々な分野のデータを共有・利用するニーズが高まっている。そこで注目されているのが、異分野のデータを連携し、一括管理・運用できる都市OSと呼ばれるソフトウェア基盤である。
    \par 本研究では、都市OSを構築するためのソフトウェアの一つであるFIWAREを用いて、佐賀市営バスデータをFIWAREへ蓄積し、蓄積されたデータを用いてバス停マップアプリの開発を行った。これにより、佐賀市営バスデータが分野横断しやすい形式に変換され、更にそのデータが実際にFIWAREから取り出して利活用出来るかどうかの検証結果を残した。
  \end{abstract}

  \tableofcontents

  \chapter{はじめに}
  \section{本研究の背景と目的}
  \par 様々な分野や領域のデータ流通が期待されるスマートシティにおいて、データを一括管理・運用し、利活用を促進するデータ流通の仕組み作りが重要になっている。しかしながら、分野や組織ごとで個別にシステムを構築しているため、独特のインターフェースや仕様をもっており、他の地域へのシステムの再利用や横展開、分野間を横断した新サービスの構築が困難であるといった課題がある。
  \par これらの解決策として注目されているのが、都市OSと呼ばれるソフトウェア基盤である。その中でも近年注目されているのが、EU（欧州連合）での官民連携投資によって開発され、世界中で活用実績がある「FIWARE（ファイウェア）」である。既に世界26カ国140都市以上がFIWAREを採用している。日本もその国の一つであり、佐賀県でも水位や人流といったデータの蓄積が行われている。しかし、まだ他国に比べて日本では実績が少なく、蓄積されていない分野のデータが多くみられる。
  \par そこで本研究では、佐賀県が公開している佐賀市営バスデータ\cite{sagaBusSite}をFIWAREへ蓄積・利活用することで、スマートシティ実現に向けて貢献することを目的とする。そのために、本研究では二つの開発を行った。一つ目はFIWAREへ蓄積するために、現状のバスデータの形式であるGTFS形式からNGSI形式に変換するツール。二つ目は、FIWAREから蓄積したバスデータを取得し、マップに表示するアプリケーションだ。
  \par これらの開発を通して、公共交通分野において統一されているGTFS形式の状態であった佐賀市営バスデータが、NGSIと呼ばれれる異分野同士で共通した標準的な形式に変換され、データが分野横断しやすくなり、さらにそれが実際にOrionから取り出して利活用出来るかどうかの検証結果を残した。

  \chapter{準備}
  この章では、本文全体で用いる専門的な用語についてまとめる

  \section{FIWARE}
  \par FIWARE とはFI（Future Internet）WARE （softWARE）の略で、自治体や企業などの業種を超え
  たデータ利活用やサービス連携を促すために開発された都市OSの一種である。EU の次 世代インターネット官民連携プログラム（FI-PPP）で
  開発・実装された。 \par FIWAREは複数のコンポーネントと呼ばれるソフトウェア群で構成されており(図2.1)、本研究ではその中でもOrion
  Context Broker(後述)と呼ばれるコンポーネントを用いることで、データを蓄積・取得する。

  \begin{figure}[H]
    \begin{center}
      \includegraphics[width=10cm]{./2-1-FIWARE.png}
      \caption{サイン関数のグラフ}
    \end{center}
  \end{figure}

  \section{Orion Context Broker}
  Orion Context Broker (以後Orion)とはFIWAREのコア（必須）となるコンポーネントである。MongoDBをデータストアとし、データを保管・管理するための機能を持っているのに加え、NGSI(後述)形式でデータを公開できる。特徴として、Orionに保管されるデータのライフサイクルは基本的に短く、最新のデータにより上書き更新される。本研究では、佐賀市営バスデータをこのOrionコンポーネントに蓄積する。
  \section{NGSI}


  \section{MakeOurCity}
  \section{GTFS}
  \section{SmartDataModel}


  \chapter{データ蓄積ツールの開発}
  \section{開発の背景}
  \par 佐賀市営バスデータを蓄積するツールを開発した経緯は二つある。 \par 一つは大量のバスデータを効率よく変換し、蓄積するためである。前提として、FIWAREのOrionにデータを蓄積するためには、Orionが受け付けるNGSI形式に一つ一つ変換し、curl等でPOSTリクエストを送る必要がある。しかし、佐賀県の路線バス情報のデータサイトからダウンロードした静的データのzipファイルの中身を見てみると、バス停の情報(stops.txt)だけでも約5000箇所もある。これらをすべて蓄積するには、ファイル単位ではなくバス停一つ一つを処理しなければならず、手間がかかることが予想できたからである。
  \par もう一つは、既存のデータ蓄積ツールがなかったからである。2022年11月時点で、著者が調査した限りにおいては、GTFSをFIWAREに蓄積するためのオープンソースとして公開されているソフトウェアは見当たらなかった。
  \section{開発環境}
  この章では、開発で用いたツールとその背景についても触れる。
  \subsection{python}
  \par
  \subsection{FAST API}
  \par
  \subsection{Amazon Cognito}
  \par
  \section{開発の概要}


  \subsection{開発手順}
  FIWAREにデータを蓄積する方法はFIWAREの公式ドキュメントを参考にした。手順をまとめると以下のとおりである。
  \begin{enumerate}
    \item 佐賀市営バスデータの取得

    \item GTFS形式のバスデータをNGSI形式のバスデータに正規化する

    \item 正規化したオブジェクトをJSONに変換する

    \item そのJSONをOrionサーバにPOST
  \end{enumerate}
  \par

  \section{結果と考察}
  \par 蓄積が出来た

  \chapter{FIWAREを用いたバス停マップアプリの開発}


  \chapter{最後に}
  結論とか，まとめとか。 最後にいうのもなんだが，ベクトルの書き方。

  \chapter*{謝辞}


  謝辞には第何章とかの番号をつけなくてもよいので，そんなときは，
  \verb|\chapter*{ }| という具合に書きます。

  みなさん，ありがとう．(普通の人が見るのは，イントロと謝辞だけ...
  という説もあるから，忘れないで書く．)

  \appendix
  \chapter{付録があるときは}
  プログラム文とかを書いてページ数を稼ぎたいときは， 以下のようにしてみます。

  \begin{verbatim}
  #include <iostream>
  using namespace std;
  int main() {
      for(int i = 1; i <= 5; i++) {
          cout << "こんにちは, C++ の世界!   "  << i << endl;
      }
      return 0;
  }
  \end{verbatim}
  \verb|\usepackage{ascmac}|して\verb|screen| 環境を使うと，枠がつきます。
  \begin{screen}
    \begin{verbatim}
    #include <iostream>
    using namespace std ;
    int main() {
        for(int i = 1; i <= 5; i++) {
            cout << "こんにちは, C++ の世界!   "  << i << endl;
        }
        return 0;
    }
    \end{verbatim}
  \end{screen}

  \begin{thebibliography}{99}
    \bibitem{kanmin} 官民データ活用推進基本法 \url{https://elaws.e-gov.go.jp/document?lawid=428AC1000000103}
    \bibitem{sagaBusSite} 佐賀県の路線バス情報のデータ \url{http://opendata.sagabus.info/}
  \end{thebibliography}
\end{document}